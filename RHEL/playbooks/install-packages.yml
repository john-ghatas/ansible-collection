---
- name: "Install packages on all server and setup basic configuration"
  hosts: targets
  become: true
  tasks:
    - name: Enable the EPEL repository
      ansible.builtin.dnf:
        name:
          - epel-release
        state: present
        update_cache: true

    - name: Yum update the system
      ansible.builtin.dnf:
        name: "*"
        state: latest

    - name: Ensure packages are installed
      ansible.builtin.dnf:
        name:
          - ansible
          - distrobox
          - htop
          - neofetch
          - git
          - vim
          - zsh
          - nginx
          - cockpit
          - cockpit-pcp
          - neovim
          - mlocate
          - fail2ban
          - htop
          - jq
          - wget
        state: present
        update_cache: true
